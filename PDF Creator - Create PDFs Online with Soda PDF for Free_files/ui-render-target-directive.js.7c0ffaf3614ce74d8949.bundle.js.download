webpackJsonp_name_([151,155],{"+F0r":function(e,t,n){"use strict";var i=a(n("HSQo")),o=a(n("/jXN")),r=a(n("b8L+"));function a(e){return e&&e.__esModule?e:{default:e}}n("m4hv");var l="ui-viewer-popup-annotation-manager-module",s="ui-viewer-popup-annotation-manager-factory";o.default.module(l,[]).factory(s,["$rootScope","$timeout","$q","pdf-manager-factory","ui-viewer-popup-annotation-dialog-factory",function(e,t,n,o,a){var l=r.default.point(),s={};(0,i.default)(s,{popupDialog:{value:null,writable:!0,enumerable:!0}});return s.closeActivePopupAnnotationDialog=function(){var e=n.defer();if(!isUndefinedOrNull(s.popupDialog)){try{s.popupDialog.isClosed||s.popupDialog.close(),s.popupDialog.dispose(),t(function(){s.popupDialog=null,e.resolve()})}catch(t){e.reject(t)}return e.promise}e.resolve()},s.showPopupAnnotation=function(e,n,i,o,r,u){window.isUndefinedOrNull(n)||(function(e){if(isUndefinedOrNull(e))return!1;if(isUndefinedOrNull(s.popupDialog))return!1;try{if(!s.popupDialog.isClosed){var t=s.popupDialog.getAnnotation();if(t)return e===t}}catch(e){}return!1}(n)?s.closeActivePopupAnnotationDialog():function(e,n,i,o,r,u){if(!isUndefinedOrNull(n)){var c=a.createInstance(e,n,o,u);if(c){var d=r.getViewSize(),f=i.copy();c.setCursorPosition(f,d);var p=n.rect,g=r.mapRectToDevice(o,p);l.x=g.left+(g.right-g.left)/2,l.y=g.top+(g.bottom-g.top)/2,l=l.floor(),t(function(){s.popupDialog=c})}}}(e,n,i,o,r,u))},s.onVisibleRangeChanged=function(e,t,n){if(!isUndefinedOrNull(s.popupDialog)&&s.popupDialog.getDocument()===e.getDocument()){var i=s.popupDialog.pageIndex;(i<t||i>n)&&(window.deviceDetect.isPhone()||s.closeActivePopupAnnotationDialog())}},s.onDrawUpdated=function(e){},s}]),window.mainApp.factory(s,getConstructor(l,s,"factory"))},ECtq:function(e,t,n){"use strict";var i=u(n("OvRC")),o=u(n("/jXN")),r=u(n("7t+N")),a=u(n("C3UN")),l=u(n("kPp2"));n("JARy"),n("QMAE");var s=u(n("uYh0"));function u(e){return e&&e.__esModule?e:{default:e}}var c="ui-viewer-popup-mobile-textedit-dialog-module",d="ui-viewer-popup-mobile-textedit-dialog-factory";o.default.module(c,["pdf-manager-module","ui-viewer-textedit-module"]).factory(d,["$rootScope","$timeout","$q","pdf-manager-factory","ui-viewer-textedit-factory",function(e,t,n,u,c){var d=function(n,i){var l=this;l.isWhiteColorExist=!1,l.type="popupTextBlockDlg";var d=n,f=d.getDocument(),p=d.getPageIndex(),g=d.getTextBlock(),v=!1;l.getDocument=function(){return f},l.getTextBlock=function(){return g},l.getPageIndex=function(){return p};var m=function(e){if(!e)return null;var t=isArray(f.fonts.system)?f.fonts.system:[];t=t.concat(isArray(f.fonts.document)?f.fonts.document:[]);for(var n=0;n<t.length;n++){var i=t[n];if(i.family===e&&i)return i.format}return null},h=function(){C&&(l.isWhiteColorExist?C.addClass("white-text"):C.removeClass("white-text"))},b=function(){var e=l.isWhiteColorExist;l.isWhiteColorExist=!1;var t=l.quill.getContents();if(t){var n=t.ops;if(isArray(n)){for(var i=0;i<n.length;i++){var o=n[i];if(o.attributes&&("rgb(255, 255, 255)"===o.attributes.color||"#ffffff"===o.attributes.color)){l.isWhiteColorExist=!0;break}}e!==l.isWhiteColorExist&&h()}}},x=function(e){return e&&-1!==e.indexOf("#")?(7===e.length&&(e=e.replace("#","#ff")),e):(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#FF"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},y=function(){!function(e){l.isChanged=!1,l.isWhiteColorExist=!1;var t=[];if(e){for(var n=0;n<e.length;n++){var i={},o=e[n].font;if(o){if(o.family){var r=s.default.import("attributors/style/font"),u=o.family.replace(/\+/g,"--");s.default.register(r,!0),i.font=u}if(o.style==a.default.FontStyle.Italic?i.italic=!0:o.style==a.default.FontStyle.Bold?i.bold=!0:o.style==a.default.FontStyle.BoldItalic&&(i.italic=!0,i.bold=!0),o.size){var c=s.default.import("attributors/style/size");s.default.register(c,!0);var d=Math.round(o.size)+"px";i.size=d}o.color&&(i.color=o.color.toRgba(),l.isWhiteColorExist||(l.isWhiteColorExist=o.color.isWhite()))}var f=e[n].text;"\n"===f&&(f=""),f&&t.push({insert:f,attributes:i})}if(!l.quill)return;t.length>0&&l.quill.setContents(t);try{var p=l.quill.getFormat();p&&(l.selectedColor=p.color,l.selectedFont=p.font,l.selectedSize=p.size,l.quill.format("color",l.selectedColor,"user"),l.quill.format("font",l.selectedFont,"user"),l.quill.format("size",l.selectedSize,"user"),l.quill.update(),l.quill.insertText(0,"​","user"),l.quill.deleteText(0,1,"user"))}catch(e){}}h()}(g.lines)},w=e.$watch(function(){return(0,r.default)("span.ql-font.text-edit-font-selector.ql-picker span.ql-picker-item.ql-selected").attr("data-value")},function(e,t){e!==t&&e&&(l.selectedFont=e,B())}),k=e.$watch(function(){return(0,r.default)("span.ql-size.text-edit-size-selector.ql-picker span.ql-picker-item.ql-selected").attr("data-value")},function(e,t){e!==t&&e&&(l.selectedSize=e)});l.selectedSize=8,l.selectedColor="rgb(0, 0, 0)",l.selectedFont=null,l.boldEnable=!1,l.italicEnable=!1,l.selectionRange={},l.cursorPosInContent=-1,l.applyColor=function(e){var t="rgb("+e.value.r+", "+e.value.g+", "+e.value.b+")",n=l.quill.getSelection(!0);if(n){var i=n.index,o=n.length;0==o?(l.selectedColor=t,l.quill.format("color",l.selectedColor,"user"),"rgb(255, 255, 255)"===t||"#ffffff"===t?(l.isWhiteColorExist=!0,h()):b()):(l.selectedColor=t,l.quill.formatText(i,o,{color:l.selectedColor},"user","user"))}},l.headerTemplate="";var C=null;l.bodyTemplate=['\n     <div class="ql-container-wrapper">\n        <div id="toolbar" class="clearfix ">\n            <div class="popup-edit-content font">\n                <select title="Font" class="ql-font text-edit-font-selector"></select>\n            </div>\n            <div class="popup-edit-content">\n                <select class="ql-size text-edit-size-selector"></select>\n                <color-picker selected-color="model.selectedColor" on-color-selected="model.applyColor" qa-name="{{::id}}"></color-picker> \n<button class="ql-bold" ng-disabled="!model.boldEnable">\n    <i class="icon">\n        <svg class="icon-svg default">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-bold" />\n        </svg>\n        <svg class="icon-svg disabled">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-bold-disabled" />\n        </svg>\n    </i>\n</button>\n<button class="ql-italic" ng-disabled="!model.italicEnable">\n    <i class="icon">\n        <svg class="icon-svg default">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-italic" />\n        </svg>\n        <svg class="icon-svg disabled">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-italic-disabled" />\n        </svg>\n    </i>\n</button>                \n            </div>\n        </div>\n        <div id="editor">\n        </div>\n    </div>\n                    '].join("");var B=function(e){var t=!1,n=!1;if(!isUndefinedOrNull(l.selectedFont)){var i=isArray(f.fonts.system)?f.fonts.system:[];i=i.concat(isArray(f.fonts.document)?f.fonts.document:[]);for(var o=0;o<i.length;o++){var r=i[o];if(r.family===l.selectedFont.replace(new RegExp("--","g"),"+").replace(/'/g,"").replace(/"/g,"")){r&&(t=(r.styles.indexOf(2)>=0||r.styles.indexOf(3)>=0)&&(r.styles.indexOf(0)>=0||r.styles.indexOf(1)>=0),n=(r.styles.indexOf(1)>=0||r.styles.indexOf(3)>=0)&&(r.styles.indexOf(0)>=0||r.styles.indexOf(2)>=0),isUndefinedOrNull(e));break}}}l.boldEnable=t,l.italicEnable=n},P=function(){try{if(!l.quill)return;var e=l.quill.getContents(0,1);if(e&&e.ops)e.ops.filter(function(e){return"​"===e.insert||"\ufeff"===e.insert}).length>0&&l.quill.updateContents((new Delta).delete(1),"silent")}catch(e){}},F=function(e,n,i){if(console.log("textChanged"),"api"==i);else if("user"==i){var o=null;try{o=l.quill.getFormat()}catch(e){}0===l.quill.getText().trim().length?l.selectedFont&&t(function(){l.quill.format("color",l.selectedColor,"api"),l.quill.format("font",l.selectedFont,"api"),l.quill.format("size",l.selectedSize,"api")}):(P(),o&&t(function(){l.selectedColor=o.color})),l.isChanged=!0,b()}},q=function(e){if(console.log("selectionChanged"),e){var t=null;try{t=l.quill.getFormat()}catch(e){}if(0==e.length)t&&t.color&&(l.selectedColor=t.color);else{P();var n=l.quill.getText(e.index,e.length);console.log("User has highlighted",n)}}else console.log("Cursor not in the editor")};l.onInit=function(e){!function(e){var t=f,n=null,i=function(e,t,i){if(e)for(var o=0;o<t.length;++o){var r=document.createElement("option"),a=t[o].family.replace(/\+/g,"--");r.value=a,r.text=t[o].family,t[o].family!=i||n||(n=a,r.selected=!0),0==o&&(r.className="groupHeader",r.disabled=!0,r.selected=!1),e.append(r),!0===r.selected&&(l.selectedFont=a)}},a=s.default.import("formats/font"),u=s.default.import("attributors/style/font");if(a.whitelist=[],u.whitelist=[],t.fonts.document){var d=[];d.push({family:"Document fonts"});for(var p=0;p<t.fonts.document.length;p++){var g=t.fonts.document[p];if(d.push(g),g.family){var v=g.family.replace(/\+/g,"--");-1===a.whitelist.indexOf(v)&&a.whitelist.push(v),-1===u.whitelist.indexOf(v)&&u.whitelist.push(v)}}i((0,r.default)(".ql-font.text-edit-font-selector"),d,"Times New Roman")}if(t.fonts.system){var m=[];m.push({family:"System fonts"});for(var h=0;h<t.fonts.system.length;h++){var b=t.fonts.system[h];if(m.push(b),b.family){var x=b.family.replace(/\+/g,"--");-1===a.whitelist.indexOf(x)&&a.whitelist.push(x),-1===u.whitelist.indexOf(x)&&u.whitelist.push(x)}}i((0,r.default)(".ql-font"),m,"Times New Roman")}s.default.register(a,!0),s.default.register(u,!0);for(var y=e[0].querySelector(".ql-size");y.firstChild;)y.removeChild(y.firstChild);var w=c.getFontSizes(),k=o.default.element(y),C=s.default.import("attributors/style/size"),B=s.default.import("formats/size");C.whitelist=[],B.whitelist=[];var P=l.getTextBlock();if(P&&P.lines&&P.lines.length>0){for(var F=function(e){var t=Math.round(P.lines[e].font.size);w.find(function(e){return e===t})||w.push(t)},q=0;q<P.lines.length;q++)F(q);w.sort(function(e,t){return e-t})}for(var E=0;E<w.length;E++){var S=w[E]+"px";-1===C.whitelist.indexOf(S)&&C.whitelist.push(S),-1===B.whitelist.indexOf(S)&&B.whitelist.push(S)}s.default.register(B,!0),s.default.register(C,!0),function(e,t,n,i){if(e)for(var o=0;o<t.length;++o){var r=document.createElement("option");r.value=t[o]+(i||""),r.innerHTML=t[o],t[o]==n&&(r.selected=!0),e.append(r),!0===r.selected&&(l.selectedSize=r.value)}}(k,w,12,"px")}(e),l.quill=new s.default("#editor",{modules:{toolbar:{container:"#toolbar"}},theme:"snow",formats:["font","size","color","bold","italic"]});var t=(0,r.default)('span[data-value="Document fonts"]');t&&t.replaceWith("<span class='groupHeader' disabled><span>Document fonts</span></span>");var n=(0,r.default)('span[data-value="System fonts"]');if(n&&n.replaceWith("<span class='groupHeader' disabled><span>System fonts</span></span>"),l.selectedFont)try{P(),l.quill.insertText(0,"​",{font:l.selectedFont,size:l.selectedSize,color:l.selectedColor},"silent")}catch(e){}C=(0,r.default)("#editor div.ql-editor"),l.quill.on("text-change",F),l.quill.on("selection-change",q),(v=!u.documentRequestPermissions(f,a.default.BLPermReqObj.kBLPermReqObjContent,a.default.BLPermReqOp.kBLPermReqOpModify))&&l.quill.enable(!1),y(),B()},l.onApply=function(){if(l.isChanged&&!v){P();var e=function(){var e=l.quill.getContents();if(!e)return null;var t=e.ops;if(!isArray(t))return null;var n=[];do{if(!t||!t[t.length-1])break;var i=t[t.length-1];do{var o=i.insert.slice(-1);if(!o||"\n"!=o&&"\r"!=o&&" "!=o)break;i.insert=i.insert.substring(0,i.insert.length-1)}while(i.insert&&i.insert.length>0);if(""!=i.insert)break;t.pop()}while(t&&t[t.length-1]);if(!t||0==t.length||1==t.length&&"\n"==t[0].insert)n.push({text:""});else for(var r=0;r<t.length;r++){var s=t[r],u={text:s.insert.replace(/\u200B/g,"").replace(/\uFEFF/g,"")};if(s.attributes){var c={};if(s.attributes.font){c.F=s.attributes.font.replace(/"/g,""),c.F=c.F.replace(/'/g,""),c.F=c.F.replace(new RegExp("--","g"),"+");var d=m(c.F);isUndefinedOrNull(d)||(c.f=d)}if((s.attributes.italic||s.attributes.bold)&&(s.attributes.italic&&s.attributes.bold?c.s=a.default.FontStyle.BoldItalic:s.attributes.italic?c.s=a.default.FontStyle.Italic:c.s=a.default.FontStyle.Bold),s.attributes.size){var f=s.attributes.size.indexOf("px");c.S=parseInt(f>-1?s.attributes.size.substring(0,f):s.attributes.size)}if(s.attributes.color){var p=x(s.attributes.color);c.C=p}u.font=c}n.push(u)}return n}();e&&u.editText(f,p,g,e).then(function(){y(),d.updateTransform(),i&&i()})}},l.dispose=function(){l.quill&&(l.quill.off("text-change",F),l.quill.off("selection-change",q),w(),k(),l.quill=null)},l.isChanged=!1};d.prototype=(0,i.default)(l.default.getPrototype());var f={createInstance:function(e,t){return isUndefinedOrNull(e)?null:new d(e,t)}};return f}]),window.mainApp.factory(d,getConstructor(c,d,"factory"))},EE8V:function(e,t,n){"use strict";var i=a(n("Xxa5")),o=a(n("exGp")),r=a(n("C3UN"));function a(e){return e&&e.__esModule?e:{default:e}}n("3Gts"),n("a2o8"),n("rJ5S"),n("itZ0"),n("1c85"),n("r1RI");var l="ui-viewer-inputhandlers-edit-module",s="ui-viewer-inputhandlers-edit-factory";angular.module(l,["bl-edit-input-snapdata-module","bl-edit-objectpicker-module","bl-edit-annot-module","bl-edit-content-module","bl-edit-compositeeditobject-module","bl-edit-utilites-module","bl-edit-multiselecttransformer-module","pdf-feature-module","bl-editmodule-module"]).factory(s,["$rootScope","$injector","bl-edit-input-snapdata-factory","bl-edit-objectpicker-factory","bl-edit-annot-service","bl-edit-content-service","bl-edit-compositeeditobject-factory","bl-edit-utilites-service","bl-edit-multiselecttransformer-factory","pdf-feature-factory","bl-editmodule-service",function(e,t,n,a,l,s,u,c,d,f,p){var g={},v=function(e,t){return f.isFeaturePermitted(e,t)};return g.createInstance=function(e,f){return new function(e){var f=e,g=!1,m=!1,h=null,b=function(e){var t=null,n=f.getPageAtPoint(e);if(isUndefinedOrNull(n)||n<0)return t;var i=f.mapPointToPage(n,e);return i&&(t={index:n,pos:i}),t},x=function(e){return u.getSelectedObjectsOnPage(f,e)},y=function(){h=null},w=function(){var e=(0,o.default)(i.default.mark(function e(t,n){var o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.selectObject(f,t,n);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),k=function(e){return s.addObjectToSelection(f,e)},C=function(e,t,n){var i=l.select(f,e,t,n);return!!n||i},B=null,P=function(e,n,i){if(!B)try{B=t.get("esl-edit-service")}catch(e){}return B?i?B.highlight(f,e,n):B.select(f,e,n):null},F=function(e,t){if(-1!=e){var n=f.document.getPage(e);if(!n)return null;var i=n.annotations;if(isUndefinedOrNull(i))return null;for(var o=f.getViewState(),a=0;a<i.length;a++){var l=i[a];if(l&&window.isUndefinedOrNull(l.parentIndex)&&l.type!==r.default.pdfAnnotationType.popup&&!isUndefinedOrNull(l.rect)&&l.isVisible&&l.rect.containsPoint(t)){if((o&r.default.PDPageRenderFlags.kPDPageRenderSkipMarkupAnnots)==r.default.PDPageRenderFlags.kPDPageRenderSkipMarkupAnnots&&l.isMarkup())continue;return l}}}return null},q=function(e,t){var n=f.document;if(!n)return!1;var i=n.getPage(e);if(!i.isLoaded)return!1;var o=i.getReadContent(),r={permitted:!0};return E(o,t,null,r),r.permitted},E=function e(t,n,i,o){for(var a=t.length;a>0;--a){var l=t[a-1];if(l)switch(l.type){case r.default.PDEElementType.kPDEElementContainer:if(!c.shouldSkipContainer(l)&&l.isVisible&&e(l.content,n,i,o))return!0;break;case r.default.PDEElementType.kPDEElementText:if(l.getItemAtPoint(n))return o.permitted=v("Edit.Common",!0),!0;break;case r.default.PDEElementType.kPDEElementXObject:if(l.isVisible&&l.hitTest(n))return o.permitted=v("Edit.Common",!0),!0;break;case r.default.PDEElementType.kPDEElementPath:if(l.hitTest(n))return o.permitted=v("Edit.Common",!0),!0;break;case r.default.PDEElementType.kPDEElementInlineImage:case r.default.PDEElementType.kPDEElementShading:if(l.hitTest(n))return o.permitted=v("Edit.Common",!0),!0}}return!1},S=function(e,t){var n={pointerArgs:{}};return n.type=r.default.BLInputEventType.kBLInputEventPointerPressed,n.pointerArgs.button=r.default.BLPointerButton.kBLPointerButtonLeft,n.pointerArgs.position=t,n.pointerArgs.flags=0,e.handleEvent(n)},L=function(e,t){var n={pointerArgs:{}};return n.type=r.default.BLInputEventType.kBLInputEventPointerPressed,n.pointerArgs.button=r.default.BLPointerButton.kBLPointerButtonRight,n.pointerArgs.position=t,n.pointerArgs.flags=0,e.handleEvent(n)};this.initialize=function(){y(),this.onDraw=function(e,t){h&&t==h.getPageIndex()&&h.draw(e,t)}},this.terminate=function(){y(),f=null},this.getToolName=function(){return"edit"},this.isFinished=function(){return!1},this.handleEvent=function(){var e=(0,o.default)(i.default.mark(function e(t){return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next=e.t0===r.default.BLInputEventType.kBLInputEventPointerDoubleClicked?3:e.t0===r.default.BLInputEventType.kBLInputEventPointerPressed?4:e.t0===r.default.BLInputEventType.kBLInputEventPointerReleased?15:e.t0===r.default.BLInputEventType.kBLInputEventPointerMoved?26:29;break;case 3:return e.abrupt("return",this.onLDoubleClicked(t.pointerArgs.position,t.pointerArgs.flags));case 4:if(t.pointerArgs.button!==r.default.BLPointerButton.kBLPointerButtonLeft){e.next=10;break}return e.next=7,this.onLButtonDown(t.pointerArgs.position,t.pointerArgs.flags);case 7:return e.abrupt("return",e.sent);case 10:if(t.pointerArgs.button!==r.default.BLPointerButton.kBLPointerButtonRight){e.next=14;break}return e.next=13,this.onRButtonDown(t.pointerArgs.position,t.pointerArgs.flags);case 13:return e.abrupt("return",e.sent);case 14:return e.abrupt("break",30);case 15:if(t.pointerArgs.button!==r.default.BLPointerButton.kBLPointerButtonLeft){e.next=21;break}return e.next=18,this.onLButtonUp(t.pointerArgs.position,t.pointerArgs.flags);case 18:return e.abrupt("return",e.sent);case 21:if(t.pointerArgs.button!==r.default.BLPointerButton.kBLPointerButtonRight){e.next=25;break}return e.next=24,this.onRButtonUp(t.pointerArgs.position,t.pointerArgs.flags);case 24:return e.abrupt("return",e.sent);case 25:return e.abrupt("break",30);case 26:return e.next=28,this.onMouseMove(t.pointerArgs.position,t.pointerArgs.flags);case 28:return e.abrupt("return",e.sent);case 29:return e.abrupt("return",!1);case 30:return e.abrupt("return",!0);case 31:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),this.onLDoubleClicked=function(e,t){try{return p.setupTextEditTool(f,e),!0}catch(e){}return!1},this.removed=function(){return!1},this.focusAnnot=function(e,t){return!1},this.restoreSelection=function(){},this.onLButtonDown=function(){var e=(0,o.default)(i.default.mark(function e(t,n){var o,l,s,u,c,d,p,v;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!deviceDetect.isPhone()){e.next=8;break}if(!(o=f.getSelection())){e.next=8;break}if(!1!==o.hitTest(t)){e.next=8;break}return f.setActiveTool("view"),f.resetSelection(),e.abrupt("return",!0);case 8:if(!(l=b(t))){e.next=61;break}return f.setFocusPage(l.index),s=null,e.prev=12,e.next=15,P(l.index,l.pos,!1);case 15:if(!(s=e.sent)){e.next=18;break}return e.abrupt("return",S(s,t));case 18:e.next=22;break;case 20:e.prev=20,e.t0=e.catch(12);case 22:return e.prev=22,u=F(l.index,l.pos),e.next=26,C(l.index,u,!1);case 26:if(s=e.sent,!u){e.next=31;break}if(!s){e.next=30;break}return e.abrupt("return",S(s,t));case 30:return e.abrupt("return",!0);case 31:e.next=35;break;case 33:e.prev=33,e.t1=e.catch(22);case 35:if(q(l.index,l.pos)){e.next=38;break}return r.default.BLFlagIsSet(n,r.default.BLInputEventFlags.kBLInputEventFlagCtrlPressed)||f.setSelection(null),e.abrupt("return",!0);case 38:if(!(c=a.createEditObjectByPagePoint(f,l.index,l.pos))){e.next=58;break}if(d=!1,!r.default.BLFlagIsSet(n,r.default.BLInputEventFlags.kBLInputEventFlagCtrlPressed)){e.next=47;break}p=k(c),s=p.inputHandler,d=p.selected,e.next=52;break;case 47:return e.next=49,w(c,!1);case 49:v=e.sent,s=v.inputHandler,d=v.selected;case 52:if(!d){e.next=56;break}if(!s){e.next=55;break}return e.abrupt("return",S(s,t));case 55:return e.abrupt("return",!0);case 56:e.next=61;break;case 58:return r.default.BLFlagIsSet(n,r.default.BLInputEventFlags.kBLInputEventFlagCtrlPressed)||f.setSelection(null),g=!0,e.abrupt("return",!0);case 61:return m=!0,f.pointerPressed(t),e.abrupt("return",!0);case 64:case"end":return e.stop()}},e,this,[[12,20],[22,33]])}));return function(t,n){return e.apply(this,arguments)}}(),this.onLButtonUp=function(){var e=(0,o.default)(i.default.mark(function e(t,o){var r,a,l,s,c,p,v,b;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m&&(f.pointerReleased(t),f.resetSelection(!0),m=!1),g&&(g=!1),h&&(h.end()?(r=h.getSelectedObjects()).getCount()>1?(a=h.getPageIndex(),l=[],u.copyFromCompositeToEditObjectStore(r,l),(s=n.createInstance())&&(c=f.document.getPage(a),p=c.getPageBox(),s.setPageBox(p.copy())),y(),v=d.createInstance(f.document,a,l,s),f.setSelectionAndTool("MultiSelect",v)):(y(),b=r.get(0),w(b,!1,null)):(y(),f.invalidate()),y()),e.abrupt("return",!1);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),this.onRButtonDown=function(){var e=(0,o.default)(i.default.mark(function e(t,n){var o,r,l,s,u;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=b(t))){e.next=42;break}if(f.setFocusPage(o.index),r=null,e.prev=4,!(r=P(o.index,o.pos,!1))){e.next=8;break}return e.abrupt("return",L(r,t));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:if(e.prev=12,l=F(o.index,o.pos),r=C(o.index,l,!1),!l){e.next=19;break}if(!r){e.next=18;break}return e.abrupt("return",L(r,t));case 18:return e.abrupt("return",!0);case 19:e.next=23;break;case 21:e.prev=21,e.t1=e.catch(12);case 23:if(q(o.index,o.pos)){e.next=26;break}return f.setSelection(null),e.abrupt("return",!0);case 26:if(!(s=a.createEditObjectByPagePoint(f,o.index,o.pos))){e.next=40;break}return e.next=31,w(s,!1);case 31:if(u=e.sent,r=u.inputHandler,!u.selected){e.next=38;break}if(!r){e.next=37;break}return e.abrupt("return",L(r,t));case 37:return e.abrupt("return",!0);case 38:e.next=42;break;case 40:return f.setSelection(null),e.abrupt("return",!0);case 42:return e.abrupt("return",!1);case 43:case"end":return e.stop()}},e,this,[[4,10],[12,21]])}));return function(t,n){return e.apply(this,arguments)}}(),this.onRButtonUp=function(e,t){return f.showContextMenu(r.default.ContextMenuType.Edit,e,r.default.BLSelectionOperations.kBLSelectionAllowPaste),!0},this.onMouseMove=function(){var e=(0,o.default)(i.default.mark(function e(t,n){var o,l,s,u,c,d,p,v;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!g){e.next=5;break}return(o=b(t))&&(y(),h&&h.begin(o.pos),f.invalidate()),g=!1,e.abrupt("return",!0);case 5:if(!h){e.next=9;break}return-1!=(l=h.getPageIndex())&&(s=f.mapPointToPage(l,t),h.continue(s),(u=x(l))&&h.selectEqual(u),f.invalidate()),e.abrupt("return",!0);case 9:if(!m){e.next=12;break}return f.pointerMoved(t),e.abrupt("return",!0);case 12:if(f.setCursor(r.default.BLCursorType.kBLCursorArrow),!(c=b(t))){e.next=36;break}if(e.prev=15,!P(c.index,c.pos,!0)){e.next=18;break}return e.abrupt("return",!0);case 18:e.next=22;break;case 20:e.prev=20,e.t0=e.catch(15);case 22:if(e.prev=22,!(d=F(c.index,c.pos))||!C(c.index,d,!0)){e.next=26;break}return e.abrupt("return",!0);case 26:e.next=30;break;case 28:e.prev=28,e.t1=e.catch(22);case 30:return p=a.createEditObjectByPagePoint(f,c.index,c.pos),e.next=33,w(p,!0);case 33:if(v=e.sent,!p||!v){e.next=36;break}return e.abrupt("return",!0);case 36:return f.setHighlight(null),f.pointerMoved(t),e.abrupt("return",!0);case 39:case"end":return e.stop()}},e,this,[[15,20],[22,28]])}));return function(t,n){return e.apply(this,arguments)}}()}(f)},g}]),window.mainApp.factory(s,getConstructor(l,s,"factory"))},FQLE:function(e,t,n){"use strict";var i=u(n("OvRC")),o=u(n("/jXN")),r=u(n("7t+N")),a=u(n("C3UN")),l=u(n("kPp2"));n("JARy"),n("QMAE");var s=u(n("uYh0"));function u(e){return e&&e.__esModule?e:{default:e}}var c="ui-viewer-popup-textedit-dialog-module",d="ui-viewer-popup-textedit-dialog-factory";o.default.module(c,["pdf-manager-module","ui-viewer-textedit-module"]).factory(d,["$rootScope","$timeout","$q","pdf-manager-factory","ui-viewer-textedit-factory",function(e,t,n,u,c){var d=function(n,i){var l=this;l.isWhiteColorExist=!1,l.type="popupTextBlockDlg";var d=n,f=d.getDocument(),p=d.getPageIndex(),g=d.getTextBlock(),v=!1;l.getDocument=function(){return f},l.getTextBlock=function(){return g},l.getPageIndex=function(){return p};var m=function(e){if(!e)return null;var t=isArray(f.fonts.system)?f.fonts.system:[];t=t.concat(isArray(f.fonts.document)?f.fonts.document:[]);for(var n=0;n<t.length;n++){var i=t[n];if(i.family===e&&i)return i.format}return null},h=function(){if(l.quill){var e=(0,r.default)("#editor div.ql-editor");e&&(l.isWhiteColorExist?e.addClass("white-text"):e.removeClass("white-text"))}},b=function(){var e=l.isWhiteColorExist;l.isWhiteColorExist=!1;var t=l.quill.getContents();if(t){var n=t.ops;if(isArray(n)){for(var i=0;i<n.length;i++){var o=n[i];if(o.attributes&&("rgb(255, 255, 255)"===o.attributes.color||"#ffffff"===o.attributes.color)){l.isWhiteColorExist=!0;break}}e!==l.isWhiteColorExist&&h()}}},x=function(e){return e&&-1!==e.indexOf("#")?(7===e.length&&(e=e.replace("#","#ff")),e):(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#FF"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},y=function(){!function(e){l.isChanged=!1,l.isWhiteColorExist=!1;var t=[];if(e){for(var n=0;n<e.length;n++){var i={},o=e[n].font;if(o){if(o.family){var r=s.default.import("attributors/style/font"),u=o.family.replace(/\+/g,"--");s.default.register(r,!0),i.font=u}if(o.style==a.default.FontStyle.Italic?i.italic=!0:o.style==a.default.FontStyle.Bold?i.bold=!0:o.style==a.default.FontStyle.BoldItalic&&(i.italic=!0,i.bold=!0),o.size){var c=s.default.import("attributors/style/size");s.default.register(c,!0);var d=Math.round(o.size)+"px";i.size=d}o.color&&(i.color=o.color.toRgba(),l.isWhiteColorExist||(l.isWhiteColorExist=o.color.isWhite()))}var f=e[n].text;"\n"===f&&(f=""),f&&t.push({insert:f,attributes:i})}if(!l.quill)return;t.length>0&&l.quill.setContents(t);try{var p=l.quill.getFormat();p&&(l.selectedColor=p.color,l.selectedFont=p.font,l.selectedSize=p.size,l.quill.format("color",l.selectedColor,"user"),l.quill.format("font",l.selectedFont,"user"),l.quill.format("size",l.selectedSize,"user"),l.quill.update(),l.quill.insertText(0,"​","user"),l.quill.deleteText(0,1,"user"))}catch(e){}}h()}(g.lines)},w=e.$watch(function(){return(0,r.default)("span.ql-font.text-edit-font-selector.ql-picker span.ql-picker-label").attr("data-value")},function(e,t){e!==t&&e&&(l.selectedFont=e,C())}),k=e.$watch(function(){return(0,r.default)("span.ql-size.text-edit-size-selector.ql-picker span.ql-picker-item.ql-selected").attr("data-value")},function(e,t){e!==t&&e&&(l.selectedSize=e)});l.selectedSize=8,l.selectedColor="rgb(0, 0, 0)",l.selectedFont=null,l.boldEnable=!1,l.italicEnable=!1,l.selectionRange={},l.cursorPosInContent=-1,l.applyColor=function(e){var t="rgb("+e.value.r+", "+e.value.g+", "+e.value.b+")",n=l.quill.getSelection(!0);if(n){var i=n.index,o=n.length;0==o?(l.selectedColor=t,l.quill.format("color",l.selectedColor,"user"),"rgb(255, 255, 255)"===t||"#ffffff"===t?(l.isWhiteColorExist=!0,h()):b()):(l.selectedColor=t,l.quill.formatText(i,o,{color:l.selectedColor},"user","user"))}},l.headerTemplate="",l.bodyTemplate=['\n     <div class="ql-container-wrapper">\n        <div id="toolbar" class="clearfix ">\n            <div class="popup-edit-content font">\n                <select title="Font" class="ql-font text-edit-font-selector"></select>\n            </div>\n            <div class="popup-edit-content">\n                <select class="ql-size text-edit-size-selector"></select>\n                <color-picker selected-color="model.selectedColor" on-color-selected="model.applyColor" qa-name="popuptexteditbtn"></color-picker> \n<button class="ql-bold" ng-disabled="!model.boldEnable">\n    <i class="icon">\n        <svg class="icon-svg default">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-bold" />\n        </svg>\n        <svg class="icon-svg disabled">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-bold-disabled" />\n        </svg>\n    </i>\n</button>\n<button class="ql-italic" ng-disabled="!model.italicEnable">\n    <i class="icon">\n        <svg class="icon-svg default">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-italic" />\n        </svg>\n        <svg class="icon-svg disabled">\n            <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="images/symbol-defs-edit.svg#icon-font-italic-disabled" />\n        </svg>\n    </i>\n</button>                \n            </div>\n        </div>\n        <div id="editor" style="white-space: normal;">\n        </div>\n    </div>\n                    '].join("");var C=function(e){var t=!1,n=!1;if(!isUndefinedOrNull(l.selectedFont)){var i=isArray(f.fonts.system)?f.fonts.system:[];i=i.concat(isArray(f.fonts.document)?f.fonts.document:[]);for(var o=0;o<i.length;o++){var r=i[o];if(r.family===l.selectedFont.replace(new RegExp("--","g"),"+").replace(/'/g,"").replace(/"/g,"")){r&&(t=(r.styles.indexOf(2)>=0||r.styles.indexOf(3)>=0)&&(r.styles.indexOf(0)>=0||r.styles.indexOf(1)>=0),n=(r.styles.indexOf(1)>=0||r.styles.indexOf(3)>=0)&&(r.styles.indexOf(0)>=0||r.styles.indexOf(2)>=0),isUndefinedOrNull(e));break}}}l.boldEnable=t,l.italicEnable=n},B=function(e,t,n){if(console.log("textChanged"),"api"==n);else if("user"==n){var i=null;try{i=l.quill.getFormat()}catch(e){}0===l.quill.getText().trim().length?l.selectedFont&&(l.quill.format("color",l.selectedColor,"user"),l.quill.format("font",l.selectedFont,"user"),l.quill.format("size",l.selectedSize,"user")):i&&(l.selectedColor=i.color),i&&(i.bold&&l.quill.format("bold",i.bold),i.italic&&l.quill.format("italic",i.italic)),l.isChanged=!0,b()}},P=function(t){if(console.log("selectionChanged"),t)if(0==t.length){var n=l.quill.getFormat();n&&(l.selectedColor=n.color,e.$$phase||e.$digest())}else{var i=l.quill.getText(t.index,t.length);console.log("User has highlighted",i)}else console.log("Cursor not in the editor")};l.onInit=function(e){!function(e){var t=f,n=null,i=function(e,t,i){if(e)for(var o=0;o<t.length;++o){var r=document.createElement("option"),a=t[o].family.replace(/\+/g,"--");r.value=a,r.text=t[o].family,t[o].family!=i||n||(n=a,r.selected=!0),0==o&&(r.className="groupHeader",r.disabled=!0,r.selected=!1),e.append(r),!0===r.selected&&(l.selectedFont=a)}},a=s.default.import("formats/font"),u=s.default.import("attributors/style/font");if(a.whitelist=[],u.whitelist=[],t.fonts.document){var d=[];d.push({family:"Document fonts"});for(var p=0;p<t.fonts.document.length;p++){var g=t.fonts.document[p];if(d.push(g),g.family){var v=g.family.replace(/\+/g,"--");-1===a.whitelist.indexOf(v)&&a.whitelist.push(v),-1===u.whitelist.indexOf(v)&&u.whitelist.push(v)}}i((0,r.default)(".ql-font.text-edit-font-selector"),d,"Times New Roman")}if(t.fonts.system){var m=[];m.push({family:"System fonts"});for(var h=0;h<t.fonts.system.length;h++){var b=t.fonts.system[h];if(m.push(b),b.family){var x=b.family.replace(/\+/g,"--");-1===a.whitelist.indexOf(x)&&a.whitelist.push(x),-1===u.whitelist.indexOf(x)&&u.whitelist.push(x)}}i((0,r.default)(".ql-font"),m,"Times New Roman")}s.default.register(a,!0),s.default.register(u,!0);for(var y=e[0].querySelector(".ql-size");y.firstChild;)y.removeChild(y.firstChild);var w=c.getFontSizes(),k=o.default.element(y),C=s.default.import("attributors/style/size"),B=s.default.import("formats/size");C.whitelist=[],B.whitelist=[];var P=l.getTextBlock();if(P&&P.lines&&P.lines.length>0){for(var F=function(e){var t=Math.round(P.lines[e].font.size);w.find(function(e){return e===t})||w.push(t)},q=0;q<P.lines.length;q++)F(q);w.sort(function(e,t){return e-t})}for(var E=0;E<w.length;E++){var S=w[E]+"px";-1===C.whitelist.indexOf(S)&&C.whitelist.push(S),-1===B.whitelist.indexOf(S)&&B.whitelist.push(S)}s.default.register(B,!0),s.default.register(C,!0),function(e,t,n,i){if(e)for(var o=0;o<t.length;++o){var r=document.createElement("option");r.value=t[o]+(i||""),r.innerHTML=t[o],t[o]==n&&(r.selected=!0),e.append(r),!0===r.selected&&(l.selectedSize=r.value)}}(k,w,12,"px")}(e),l.quill=new s.default("#editor",{modules:{toolbar:{container:"#toolbar"}},theme:"snow",formats:["font","size","color","bold","italic"]}),(0,r.default)("#editor div.ql-editor").css("white-space","pre-wrap");var n=(0,r.default)('span[data-value="Document fonts"]');n&&n.replaceWith("<span class='groupHeader' disabled><span>Document fonts</span></span>");var i=(0,r.default)('span[data-value="System fonts"]');i&&i.replaceWith("<span class='groupHeader' disabled><span>System fonts</span></span>"),l.selectedFont&&(l.quill.format("color",l.selectedColor,"user"),l.quill.format("font",l.selectedFont,"user"),l.quill.format("size",l.selectedSize,"user")),t(function(){l.quill.focus(),l.quill.update()}),l.quill.on("text-change",B),l.quill.on("selection-change",P),(v=!u.documentRequestPermissions(f,a.default.BLPermReqObj.kBLPermReqObjContent,a.default.BLPermReqOp.kBLPermReqOpModify))&&l.quill.enable(!1),y(),C()},l.onApply=function(){if(l.isChanged&&!v){var e=function(){var e=l.quill.getContents();if(!e)return null;var t=e.ops;if(!isArray(t))return null;var n=[];do{if(!t||!t[t.length-1])break;var i=t[t.length-1];do{var o=i.insert.slice(-1);if(!o||"\n"!=o&&"\r"!=o&&" "!=o)break;i.insert=i.insert.substring(0,i.insert.length-1)}while(i.insert&&i.insert.length>0);if(""!=i.insert)break;t.pop()}while(t&&t[t.length-1]);if(!t||0==t.length||1==t.length&&"\n"==t[0].insert)n.push({text:""});else for(var r=0;r<t.length;r++){var s=t[r],u={text:s.insert.replace(/\u200B/g,"").replace(/\uFEFF/g,"")};if(s.attributes){var c={};if(s.attributes.font){c.F=s.attributes.font.replace(/"/g,""),c.F=c.F.replace(/'/g,""),c.F=c.F.replace(new RegExp("--","g"),"+");var d=m(c.F);isUndefinedOrNull(d)||(c.f=d)}if((s.attributes.italic||s.attributes.bold)&&(s.attributes.italic&&s.attributes.bold?c.s=a.default.FontStyle.BoldItalic:s.attributes.italic?c.s=a.default.FontStyle.Italic:c.s=a.default.FontStyle.Bold),s.attributes.size){var f=s.attributes.size.indexOf("px");c.S=parseInt(f>-1?s.attributes.size.substring(0,f):s.attributes.size)}if(s.attributes.color){var p=x(s.attributes.color);c.C=p}u.font=c}n.push(u)}return n}();console.log("spans: ",e),e&&u.editText(f,p,g,e).then(function(){y(),d.updateTransform(),i&&i()})}},l.dispose=function(){l.quill&&(w(),k(),l.quill.off("text-change",B),l.quill.off("selection-change",P),l.quill=null)},l.isChanged=!1};d.prototype=(0,i.default)(l.default.getPrototype());var f={createInstance:function(e,t){return isUndefinedOrNull(e)?null:new d(e,t)}};return f}]),window.mainApp.factory(d,getConstructor(c,d,"factory"))},JARy:function(e,t,n){"use strict";var i=s(n("HSQo")),o=s(n("C3UN")),r=s(n("IZAc")),a=s(n("3Ejq")),l=s(n("SWEh"));function s(e){return e&&e.__esModule?e:{default:e}}var u="ui-viewer-textedit-factory";angular.module("ui-viewer-textedit-module",[]).factory(u,["$rootScope","ui-usersettings-factory","pdf-manager-factory",function(e,t,n){var s=function(e){return{id:e.family,text:e.family,format:function(e){return e===o.default.FontFormat.Type1?"t1":e===o.default.FontFormat.TrueType?"tt":e===o.default.FontFormat.Type3?"t3":""}(e.format),value:e}},u=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],c={documents:{},getFontSizes:function(){return saveSlice(u)},getFontSizesDropDown:function(){for(var e=this.getFontSizes(),t=new Array(e.length),n=0,i=e.length;n<i;++n){var o=e[n];t[n]={id:o,text:o,value:o}}return t},setSelectedFont:function(e,t){if(e){var n=c.documents[e.id];n&&(n.selectedFont=t)}},getSelectedFont:function(e){if(!e)return null;var t=c.documents[e.id];return t?t.selectedFont:null},getRibbonBarFontCollection:function(e){if(!e)return null;var t=c.documents[e.id];return t?t.ribbonBarFontCollection:null}};c.rgbColors=l.default.rgbaColors;var d=function(l){var u=c.documents[l.id];u||(u={id:l.id},c.documents[l.id]=u),u.font=l.fonts,u.selectedFont=new function(t,l,s,u,c){var d=this,f=isUndefinedOrNull(t)?{}:t,p=isUndefinedOrNull(l)?{id:12,text:12}:l,g=!isUndefinedOrNull(s)&&s,v=!isUndefinedOrNull(u)&&u,m=isUndefinedOrNull(c)?r.default.createInstance():c,h=function(t){e.$broadcast("event-document-selected-font-changed",{document:n.currentDocument(),font:d,propertyName:t})};d.toPdfFont=function(){var e=o.default.FontStyle.Regular;return g&&v?e=o.default.FontStyle.BoldItalic:g?e=o.default.FontStyle.Bold:v&&(e=o.default.FontStyle.Italic),a.default.createInstance({F:f.value.family,f:f.value.format,C:m.toString(!0,!1),S:p.id,s:e})},(0,i.default)(this,{descriptor:{get:function(){return f},set:function(e){f!=e&&(f=e,g=v=!1,h("descriptor"))}},size:{get:function(){return p},set:function(e){p!=e&&(p=e,h("size"))}},isBold:{get:function(){return g},set:function(e){g!=e&&(g=e,h("isBold"))}},isItalic:{get:function(){return v},set:function(e){v!=e&&(v=e,h("isItalic"))}},color:{get:function(){return m},set:function(e){m.toString()!=e.toString()&&(m=e,h("color"))}}})};var d=t.settings.font.size;u.selectedFont.size={id:d,text:d},u.font&&(u.ribbonBarFontCollection=function(e){var t={document:[],system:[]};if(!e)return t;var n=c.documents[e.id];if(!n)return t;if(!n.font)return t;if(n.font.document)for(var i=0;i<n.font.document.length;i++)t.document.push(new s(n.font.document[i]));if(n.font.system)for(i=0;i<n.font.system.length;i++)t.system.push(new s(n.font.system[i]));return t}(l),u.selectedFont&&u.ribbonBarFontCollection&&u.ribbonBarFontCollection.system&&(u.selectedFont.descriptor=u.ribbonBarFontCollection.system.first(function(e){return e.value&&e.value.family===t.settings.font.family&&e.value.format===t.settings.font.format}),u.selectedFont.descriptor||(u.selectedFont.descriptor=u.ribbonBarFontCollection.system[0]))),u.isLoaded=l.isLoaded},f=n.documents||[];return function(){for(var e=0;e<f.length;e++){var t=f[e];c.documents[t.id]={id:t.id},d(t)}}(),e.$on("event-document-added",function(e,t){c.documents[t.id]={id:t.id}}),e.$on("event-document-loaded",function(e,t){d(t)}),e.$on("event-document-closed",function(e,t){delete c.documents[t.id]}),c}]),window.mainApp.factory(u,getConstructor("ui-viewer-textedit-module",u,"factory"))},dRf2:function(e,t,n){"use strict";var i=a(n("HSQo")),o=a(n("/jXN")),r=a(n("b8L+"));function a(e){return e&&e.__esModule?e:{default:e}}n("FQLE"),n("ECtq");var l="ui-viewer-popup-textedit-manager-module",s="ui-viewer-popup-textedit-manager-factory";o.default.module(l,["ui-viewer-popup-textedit-dialog-module","ui-viewer-popup-mobile-textedit-dialog-module"]).factory(s,["$rootScope","$timeout","$q","ui-viewer-popup-textedit-dialog-factory","ui-viewer-popup-mobile-textedit-dialog-factory",function(e,t,n,o,a){var l=r.default.point(),s={};(0,i.default)(s,{popupDialog:{value:null,writable:!0,enumerable:!0}});return s.closeActivePopupTextEditDialog=function(){var e=n.defer();if(!isUndefinedOrNull(s.popupDialog)){try{s.popupDialog.isClosed||s.popupDialog.close(),s.popupDialog.dispose(),t(function(){s.popupDialog=null,e.resolve()})}catch(t){e.reject(t)}return e.promise}e.resolve()},s.showPopupTextEdit=function(e,n,i){isUndefinedOrNull(e)||(function(e){if(isUndefinedOrNull(e))return!1;if(isUndefinedOrNull(s.popupDialog))return!1;try{if(!s.popupDialog.isClosed){var t=s.popupDialog.getTextBlock();if(t)return e.getTextBlock()===t}}catch(e){}return!1}(e)?s.closeActivePopupTextEditDialog():function(e,n,i){if(!window.isUndefinedOrNull(e)){var u=null;if(u=window.deviceDetect.isPhone()?a.createInstance(e,function(){i&&t(function(){i.setActiveTool("view")},100)}):o.createInstance(e)){var c=i.getViewSize(),d=n.copy();d.x-=u.width/2,deviceDetect.isPhone()&&(d=r.default.point()),u.setCursorPosition(d,c);var f=e.getTextBlock().rect,p=i.mapRectToDevice(e.getPageIndex(),f);l.x=p.left+(p.right-p.left)/2,l.y=p.top+(p.bottom-p.top)/2,l=l.floor(),t(function(){s.popupDialog=u})}}}(e,n,i))},s.onVisibleRangeChanged=function(e,t,n){if(!isUndefinedOrNull(s.popupDialog)&&s.popupDialog.getDocument()===e.getDocument()){var i=s.popupDialog.getPageIndex();(i<t||i>n)&&s.closeActivePopupTextEditDialog()}},s.onDrawUpdated=function(e){},s}]),window.mainApp.factory(s,getConstructor(l,s,"factory"))},kPp2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n("HSQo")),o=r(n("b8L+"));function r(e){return e&&e.__esModule?e:{default:e}}var a=function(){};(0,i.default)(a.prototype,{left:{value:0,writable:!0,enumerable:!0},top:{value:0,writable:!0,enumerable:!0},minWidth:{value:352,writable:!0,enumerable:!0},width:{value:352,writable:!0,enumerable:!0},minHeight:{value:224,writable:!0,enumerable:!0},height:{value:224,writable:!0,enumerable:!0},isClosed:{value:!1,writable:!0,enumerable:!0}}),a.prototype.optimizePosToBounds=function(e,t){return(e=o.default.point(e.x/devicePixelRatio,e.y/devicePixelRatio)).x+this.width>t.width&&(e.x-=e.x+this.width-t.width),e.y+this.height>t.height&&(e.y-=e.y+this.height-t.height),e.x<0&&(e.x=0),e.y<0&&(e.y=0),e},a.prototype.setCursorPosition=function(e,t){var n=this.optimizePosToBounds(e,t);this.left=n.x,this.top=n.y,this.width>t.width&&(this.width=t.width),this.height>t.height&&(this.height=t.height)},a.prototype.move=function(e,t,n){this.setCursorPosition(o.default.point(this.left+e,this.top+t),n)},a.prototype.resize=function(e,t){var n=Math.max(Math.min(t.width-this.left,e.width),this.minWidth),i=Math.max(Math.min(t.height-this.top,e.height),this.minHeight);this.width=n,this.height=i},a.prototype.resizeLeftBottom=function(e,t,n,i,o){var r=t;r=Math.max(this.minWidth-e.width,t);var a=i-(r=Math.min(i,r)),l=e.width+r,s=Math.max(Math.min(o.height-this.top,e.height+n),this.minHeight);this.left=a,this.width=l,this.height=s},a.prototype.close=function(){this.isClosed=!1},t.default={getPrototype:function(){return a.prototype}}},m4hv:function(e,t,n){"use strict";var i=s(n("OvRC")),o=s(n("HSQo")),r=s(n("/jXN")),a=s(n("C3UN")),l=s(n("kPp2"));function s(e){return e&&e.__esModule?e:{default:e}}var u="ui-viewer-popup-annotation-dialog-module",c="ui-viewer-popup-annotation-dialog-factory";r.default.module(u,[]).factory(c,["$rootScope","$timeout","$q","pdf-manager-factory",function(e,t,n,r){var s=function(e,t,n){var i=this,l=e,s=t,u=n,c=!1,d="";(0,o.default)(i,{annotation:{value:s},pageIndex:{value:u},content:{get:function(){return d},set:function(e){isUndefinedOrNull(e)&&(e=""),this.content!=e&&(i.isChanged=!0,d=e)}},isReadOnly:{get:function(){return c}},isLocked:{get:function(){return s.isLocked}}});var f=function(){d=s.content,i.isChanged=!1};f(),i.getDocument=function(){return l},i.getAnnotation=function(){return i.annotation};c=!r.documentRequestPermissions(l,a.default.BLPermReqObj.kBLPermReqObjAnnot,a.default.BLPermReqOp.kBLPermReqOpModify),i.headerTemplate=['<strong class="author" >{{model.annotation.titleText}}</strong>','<span class="date">{{model.annotation.creationDate | date}}</span>','<i class="lock-icon hover-tooltip" ng-if="model.isLocked">','<svg class="icon-svg"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-security-17"></use></svg>','<section class="tooltip">','<h1 translate="Locked"></h1>','<p translate="This annotation is locked. You can unlock it through the Properties panel."></p>',"</section>","</i>"].join(""),i.bodyTemplate='<div class="holder"><textarea ng-readonly="model.isReadOnly || model.isLocked" ng-model="model.content" custom-autofocus></textarea></div>',i.onInit=function(e){},i.onApply=function(){!i.isChanged||c||i.isLocked||r.changeAnnotationProperties(l,s,u,{c:d}).then(function(){s.content=d,f()})},i.dispose=function(){},i.isChanged=!1};s.prototype=(0,i.default)(l.default.getPrototype());var u=function(e,t,n){var i=this;i.type="popupViewAnnotDlg";var l=e,s=t,u=n,c=!1,d="";(0,o.default)(i,{annotation:{value:s},pageIndex:{value:u},content:{get:function(){return d},set:function(e){window.isUndefinedOrNull(e)&&(e=""),this.content!=e&&(i.isChanged=!0,d=e)}},isReadOnly:{get:function(){return c}},isLocked:{get:function(){return s.isLocked}}});i.getDocument=function(){return l},i.getAnnotation=function(){return i.annotation},d=s.content,i.isChanged=!1,c=!r.documentRequestPermissions(l,a.default.BLPermReqObj.kBLPermReqObjAnnot,a.default.BLPermReqOp.kBLPermReqOpModify),i.bodyTemplate='<div class="comment-note"><div class="icon-wrap"><span class="font-icon-message"></span></div><p>{{::model.content}}</p></div>',i.onInit=function(e){},i.dispose=function(){},i.isChanged=!1};u.prototype=(0,i.default)(l.default.getPrototype());var c={createInstance:function(e,t,n,i){return window.isUndefinedOrNull(t)?null:i?new u(e,t,n):new s(e,t,n)}};return c}]),window.mainApp.factory(c,getConstructor(u,c,"factory"))},"r/N8":function(e,t,n){"use strict";var i=a(n("C3UN")),o=a(n("b8L+")),r=a(n("7t+N"));function a(e){return e&&e.__esModule?e:{default:e}}var l="ui-viewer-inputhandlers-select-module",s="ui-viewer-inputhandlers-select-factory";angular.module(l,[]).factory(s,["$rootScope",function(e){var t={};return t.createInstance=function(e,t){return new function(e){var t=e;this.initialize=function(e){t.setCursor(i.default.BLCursorType.kBLCursorArrow)},this.terminate=function(){},this.getToolName=function(){return"select"},this.isFinished=function(){return!1},this.handleEvent=function(e){switch(e.type){case i.default.BLInputEventType.kBLInputEventPointerPressed:return this.onMouseDown(e.pointerArgs.position,e.pointerArgs.flags);case i.default.BLInputEventType.kBLInputEventPointerReleased:return this.onMouseUp(e.pointerArgs.position,e.pointerArgs.flags);case i.default.BLInputEventType.kBLInputEventPointerMoved:return this.onMouseMove(e.pointerArgs.position,e.pointerArgs.flags)}return!1},this.removed=function(){return!1},this.focusAnnot=function(e,t){return!1},this.restoreSelection=function(){},this.onMouseDown=function(e,t){return!0},this.onMouseUp=function(e,t){return!0},this.onMouseMove=function(e,n){return t.setCursor(i.default.BLCursorType.kBLCursorArrow),!0}}(t)},t}]).directive("textLayer",["$rootScope","$timeout","pdf-manager-factory",function(e,t,n){var a={};return{restrict:"E",scope:{documentView:"=ngDocumentView"},template:'<div class="textLayer"></div>',replace:!0,compile:function(){return{pre:function(e,t,i){t.empty(),e.document=null,e.pages=null,t=(0,r.default)(t);e.disposeTextBlocks=function(){if(e.documentView)for(var n=e.documentView.getVisibleRange(),i=t.children(),o=0;o<i.length;o++){var l=i[o].attributes["attr-page-index"].value;(l<n.startPage||l>n.endPage)&&((0,r.default)(i[o]).remove(),delete a[l])}};var l=function(t,i){var a=[];!function(t,n,i){if(!isUndefinedOrNull(i))for(var r=window.document.createElement("canvas").getContext("2d"),a=t.getRotate(e.document.rotate),l=0,s=i.length;l<s;++l){var u=i[l],c=o.default.radianToDegree(u.rotate),d=t.getPageToDevSpaceMatrix(e.document.zoom,e.document.rotate,t.rotate).mapPoint(u.rect.left_top()),f=t.getPageToDevSpaceMatrix(e.document.zoom,0,0).mapRect(u.rect),p=u.font.sizePx*e.document.zoom/devicePixelRatio;n[l].css({width:f.width,height:f.height,left:(d.x+t.virtualLeft)/devicePixelRatio,top:d.y/devicePixelRatio+t.virtualTop/devicePixelRatio,fontSize:p}),0===a&&0===c||n[l].css({transform:"rotate("+(a-c)+"deg)","transform-origin":"left top"}),r.font=p+"px "+u.font.selectFamily;var g=r.measureText(u.text).width,v=f.width/g/devicePixelRatio;1!==v&&n[l].find("div:first").css({transform:"scale("+v+",1)"})}}(t,a,function(t,i){var o=[],a=i.textBlocks;if(!1!==isArray(a)){for(var l=0;l<a.length;++l){var s=a[l],u=s.lines;if(!1!==isArray(u)&&n.isTextBlockVisible(e.document.id,e.document.getPageIndex(i),l))for(var c=0;c<u.length;++c){var d=u[c];d.rotate=s.rotate,d.topLeft=s.rect?s.rect.left_top():null;var f=window.document.createElement("div");f.style.fontFamily=d.font.selectFamily,f.innerHTML="<div>"+encodeHtml(d.text)+"</div>",t.push((0,r.default)(f.outerHTML)),o.push(d)}}return o}}(a,t)),i.html(a)};e.processPageTextBlocks=function(e){var n=(0,r.default)('<div attr-page-index="'+e.index+'" class="page-container"><div>');l(e,n);var i=t.find('.page-container[attr-page-index="'+e.index+'"]');if(i.length>0)l(e,i);else{var o=t.children().first();if(o.length>0&&o.attr("attr-page-index")>e.index)return void n.insertBefore(o);t.append(n)}}},post:function(t,o,l){var s=null,u=!1,c=function(){t.documentView&&(t.document=t.documentView.getDocument(),t.pages=t.documentView.getVisiblePages(),t.documentView.getActiveToolName()===i.default.pdfDocumentMode.select&&(o.css({zIndex:3}),o.parent().css({zIndex:3}),1!==devicePixelRatio&&o.css("position","absolute")))},d=function(){o.children.length>0&&(o.empty(),o.css({zIndex:0}),o.parent().css({zIndex:0})),s=null,a={},t.document=null,t.pages=null},f=function(){for(var e=t.documentView.getVisibleRange(),n=e.startPage;n<=e.endPage;n++)delete a[n]};function p(){if(1!==devicePixelRatio&&t.documentView.getActiveToolName()===i.default.pdfDocumentMode.select){var e=o.parent().parent()[0].scrollLeft;e&&(e-=e/devicePixelRatio,o.css("left",e+"px"));var n=o.parent().parent()[0].scrollTop;n&&(n-=n/devicePixelRatio,o.css("top",n+"px"))}}t.$watch("document.zoom",function(e,t){e!==t&&e&&t&&f()}),t.$watch("document.documentView",function(e,t){e!==t&&e&&t&&f()}),t.$watch("document.rotate",function(e,t){e===t||isUndefinedOrNull(e)||isUndefinedOrNull(t)||f()});var g=function(){isUndefinedOrNull(s)||(s=null)};o.bind("mouseup",g),o.bind("copy paste cut drag drop",function(e){var o=-1===["drag","drop"].indexOf(e.type);n.documentRequestPermissions(t.document,i.default.BLPermReqObj.kBLPermReqObjContent,i.default.BLPermReqOp.kBLPermReqOpExtract,o)||e.preventDefault()});var v=e.$on("event-ui-resized",function(e,n){t.documentView&&f()}),m=e.$on("event-document-active-tool-changed",function(e,n){n.documentView===t.documentView&&(n.toolName===i.default.pdfDocumentMode.select?c():d())}),h=e.$on("event-document-visible-page-text-blocks-draw",function(e,n){if(n.documentView===t.documentView)if(n.documentView.getActiveToolName()===i.default.pdfDocumentMode.select){if(n.page&&n.page.isLoaded&&!n.page.isLoading&&((isUndefinedOrNull(a[n.page.index])||a[n.page.index]!==n.page.salt)&&(a[n.page.index]=n.page.salt,t.processPageTextBlocks(n.page),u=!1,p()),!u&&!isUndefinedOrNull(s))){var l=(0,r.default)(o).find('.page-container[attr-page-index="'+s.selectedIndex+'"]').get(0);l&&(selectText(l,s.startIndex,s.endIndex),u=!0)}}else d()}),b=e.$on("event-document-visible-range-changing",function(e,n){n.documentView===t.documentView&&n.documentView.getActiveToolName()===i.default.pdfDocumentMode.select&&t.disposeTextBlocks()}),x=e.$on("event-document-selected",function(e,t){}),y=e.$on("ui-event-document-view-select-text-changed",function(e,n){n.documentView===t.documentView&&(u=!1,s=n.data)}),w=e.$on("ui-event-document-view-select-text-clear",function(e,t){isUndefinedOrNull(s)||(s=null)});function k(e){p()}t.$watch("documentView",function(e,t){e!==t&&(d(),c())}),o.parent().parent().bind("scroll",k),t.$on("$destroy",function(){o.unbind("mouseup",g),o.parent().parent().unbind("scroll",k),v(),m(),b(),h(),x(),y(),w&&w()})}}}}}]),window.mainApp.directive("textLayer",getConstructor(l,"textLayer","directive")),window.mainApp.factory(s,getConstructor(l,s,"factory"))},rJ0u:function(e,t,n){"use strict";var i=l(n("OvRC")),o=l(n("HSQo")),r=l(n("C3UN")),a=l(n("VmtT"));function l(e){return e&&e.__esModule?e:{default:e}}n("sVJW");var s="ui-viewer-inputhandlers-widgetcreate-module",u="ui-viewer-inputhandlers-widgetcreate-factory";angular.module(s,["pdf-manager-module","bl-views-frametracker-module"]).factory(u,["$rootScope","bl-views-frametracker-factory","pdf-manager-factory",function(e,t,n){var l=function(e){return e?'"'+e.replace(/\"/g,'\\"')+'"':'""'},s={},u=function(e,n){var i=n,a=!1,l=null;(0,o.default)(this,{type:{value:e.type},toolName:{value:e.toolName},pdfType:{value:e.pdfType},backgroundColor:{value:e.backgroundColor},borderColor:{value:e.borderColor},fontColor:{value:e.fontColor},caption:{value:e.caption?e.caption:""},actions:{value:e.actions?e.actions:[],writable:!0},defaultSize:{get:function(){return{width:e.defaultSize[0],height:e.defaultSize[1]}}}}),this.initialize=function(e){l&&l.dispose(),l=t.createInstance(this.defaultSize,i,"#4D82B8"),this.onInitialize&&this.onInitialize(e)},this.terminate=function(){l&&l.dispose(),l=null,i=null},this.getToolName=function(){return this.toolName},this.isFinished=function(){return!1},this.handleEvent=function(e){switch(e.type){case r.default.BLInputEventType.kBLInputEventPointerPressed:if(e.pointerArgs.button===r.default.BLPointerButton.kBLPointerButtonLeft)return this.onMouseDown(e.pointerArgs.position,e.pointerArgs.flags);break;case r.default.BLInputEventType.kBLInputEventPointerReleased:if(e.pointerArgs.button===r.default.BLPointerButton.kBLPointerButtonLeft)return this.onMouseUp(e.pointerArgs.position,e.pointerArgs.flags);break;case r.default.BLInputEventType.kBLInputEventPointerMoved:return this.onMouseMove(e.pointerArgs.position,e.pointerArgs.flags)}return!1},this.removed=function(){return!1},this.focusAnnot=function(e,t){return!1},this.restoreSelection=function(){},this.onMouseDown=function(e,t){return!!a||l.onMouseDown(e)},this.onMouseUp=function(e,t){if(a)return!0;if(l.onMouseUp(e)){var n=l.getPageIndex(),o=l.getRect();return a=!0,this.onCreateWidget(i.getDocument(),o,i.document.getPage(n).getRotate(i.document.rotate),n).finally(function(){a=!1}),!0}return!1},this.onMouseMove=function(e,t){return!!a||!!l.onMouseMove(e)&&(i.setCursor(r.default.BLCursorType.kBLCursorCross),!0)},this.onDraw=function(e,t){l&&l.draw(e,t)}};u.prototype.onCreateWidget=function(e,t,i,o){return n.documentCreateWidgetAnnotation(e,this,o,t,i)};var c=function(e){e.type="textField",e.pdfType="TextBox",e.defaultSize=a.default.Forms.TextFieldSize,u.apply(this,arguments)};c.prototype=(0,i.default)(u.prototype);var d=function(e){e.type="checkBox",e.pdfType="CheckBox",e.defaultSize=a.default.Forms.CheckBoxSize,u.apply(this,arguments)};d.prototype=(0,i.default)(u.prototype);var f=function(e){e.type="radioButton",e.pdfType="RadioButton",e.defaultSize=a.default.Forms.RadioButtonSize,e.value=1,e.parent=null,u.apply(this,arguments),(0,o.default)(this,{value:{value:1,writable:!0},parent:{value:null,writable:!0}})};f.prototype=(0,i.default)(u.prototype);var p=function(e){e.type="listBox",e.pdfType="ListBox",e.defaultSize=a.default.Forms.ListBoxSize,u.apply(this,arguments)};p.prototype=(0,i.default)(u.prototype);var g=function(e){e.type="comboBox",e.pdfType="ComboBox",e.backgroundColor="#FFFFFFFF",e.borderColor="#FFABADB3",e.fontColor="#FF4D82B8",e.defaultSize=a.default.Forms.ComboBoxSize,u.apply(this,arguments)};g.prototype=(0,i.default)(u.prototype);var v=function(e){e.type="pushButton",e.pdfType="PushButton",e.backgroundColor="#FFE7EDF5",e.borderColor="#FF7BB0E6",e.fontColor="#FF6B96C2",e.defaultSize=a.default.Forms.PushButtonSize,u.apply(this,arguments)};v.prototype=(0,i.default)(u.prototype);var m=function(e){e.caption="Submit",v.apply(this,arguments)};(m.prototype=(0,i.default)(v.prototype)).onInitialize=function(e){var t="this.submitForm("+l(e+"#FDF")+");",n={type:r.default.pdfAction.js,value:t};this.actions=[n]};var h=function(e){e.caption="Email",v.apply(this,arguments)};(h.prototype=(0,i.default)(v.prototype)).onInitialize=function(e){var t=e,n="this.mailDoc(true, "+l(t.to)+", "+l(t.cc)+", "+l(t.bcc)+", "+l(t.subject)+", "+l(t.text)+");",i={type:r.default.pdfAction.js,value:n};this.actions=[i]};var b=function(e){var t={type:r.default.pdfAction.js,value:"this.print(true);"};e.actions=[t],e.caption="Print",v.apply(this,arguments)};return b.prototype=(0,i.default)(v.prototype),s.createInstance=function(e,t){var n=null;switch(e){case"textFieldCreate":n=c;break;case"checkBoxCreate":n=d;break;case"radioButtonCreate":n=f;break;case"listBoxCreate":n=p;break;case"comboBoxCreate":n=g;break;case"pushButtonCreate":n=v;break;case"submitButtonCreate":n=m;break;case"emailButtonCreate":n=h;break;case"printButtonCreate":n=b}return isNull(n)?null:new n({toolName:e,backgroundColor:"#FFFFFFFF",borderColor:"#FFABADB3",fontColor:"#FF444444"},t)},s}]),window.mainApp.factory(u,getConstructor(s,u,"factory"))}});